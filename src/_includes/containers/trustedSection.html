<section class="ps__sectionLogos">
    <div class="ps__sectionLogos--container container">
        <div class="ps__sectionLogos--logos carousel is-set">
            {% for logo in trusted.rows %}
            {% if logo.title and logo.logo %}
            <div class='carousel-seat {% if loop.last %}is-ref{% endif %}'>
                <picture>
                    <img src="/assets/images/trusted/{{ logo.logo }}" alt="{{ logo.title }}" height="50" loading="lazy"
                        decoding="async" draggable="false" />
                </picture>
            </div>
            {% else %}
            <p>Something went wrong. Please check trusted.json</p>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</section>
<script>
    (function () {
        var carousel, next, prev, seats;

        carousel = document.querySelector('.carousel');

        seats = document.querySelectorAll('.carousel-seat');

        next = function (el) {
            if (el.nextElementSibling !== null) {
                return el.nextElementSibling;
            } else {
                return seats[0];
            }
        };

        prev = function (el) {
            if (el.previousElementSibling !== null) {
                return el.previousElementSibling;
            } else {
                return seats[seats.length - 1];
            }
        };

        document.querySelectorAll('.toggle').forEach(function (button) {
            button.addEventListener('click', function (e) {
                var el, i, j, new_seat;
                el = document.querySelector('.is-ref');
                el.classList.remove('is-ref');
                if (e.currentTarget.getAttribute('data-toggle') === 'next') {
                    new_seat = next(el);
                    carousel.classList.remove('is-reversing');
                } else {
                    new_seat = prev(el);
                    carousel.classList.add('is-reversing');
                }
                new_seat.classList.add('is-ref');
                new_seat.style.order = 1;
                for (i = 2, j = 2; j <= seats.length; i++, j++) {
                    new_seat = next(new_seat);
                    new_seat.style.order = i;
                }
                carousel.classList.remove('is-set');
                setTimeout(function () {
                    carousel.classList.add('is-set');
                }, 50);
            });
        });

        // Trigger the next function every 3 seconds
        setInterval(function () {
            var el = document.querySelector('.is-ref');
            var new_seat = next(el);
            el.classList.remove('is-ref');
            new_seat.classList.add('is-ref');
            new_seat.style.order = 1;
            for (var i = 2, j = 2; j <= seats.length; i++, j++) {
                new_seat = next(new_seat);
                new_seat.style.order = i;
            }
            carousel.classList.remove('is-set');
            setTimeout(function () {
                carousel.classList.add('is-set');
            }, 50);
        }, 3000);
    })();
</script>